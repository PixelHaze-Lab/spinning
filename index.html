<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆãƒ‡ãƒ¢</title>
  <style>
    /* CSSå¤‰æ•°ã§ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç®¡ç† */
    :root {
      --segment-count: 6;
      --segment-angle: calc(360deg / var(--segment-count));
      --wheel-size: 260px;
      /* ã€èª¿æ•´ã€‘æ–‡å­—ã‚’é…ç½®ã™ã‚‹ä¸­å¿ƒã‹ã‚‰ã®è·é›¢ã‚’åŠå¾„ã®60%ã«ç¸®å° */
      --text-radius: calc(var(--wheel-size) / 2 * 0.6); 
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin: 0;
      background: #f3f4f6;
    }

    .roulette-wrapper {
      position: relative;
      width: var(--wheel-size);
      height: var(--wheel-size);
    }

    .wheel {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 6px solid #111827;
      box-sizing: border-box;
      background: conic-gradient(
        #f97373 0deg 60deg,
        #fb923c 60deg 120deg,
        #facc15 120deg 180deg,
        #34d399 180deg 240deg,
        #60a5fa 240deg 300deg,
        #a78bfa 300deg 360deg
      );
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      transform: rotate(0deg);
    }

    /* --- ã‚»ã‚°ãƒ¡ãƒ³ãƒˆå†…ã®æ–‡å­—ã®é…ç½® --- */
    .segment-text-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .segment-text {
      position: absolute;
      color: white; 
      text-shadow: 0 0 2px #000;
      font-weight: 800;
      font-size: 24px;
      width: 20px;
      height: 20px;
      line-height: 20px;
      text-align: center;
      
      /* æ–‡å­—ã‚’ãƒ›ã‚¤ãƒ¼ãƒ«ã®ä¸­å¤®ã«é…ç½® */
      top: 50%;
      left: 50%;
      /* æ–‡å­—ã®è¦ç´ è‡ªä½“ã®ä¸­å¿ƒã‚’ä¸­å¤®ã«åˆã‚ã›ã‚‹ */
      transform: translate(-50%, -50%); 

      /* ã€èª¿æ•´ã€‘æ–‡å­—ã‚’æ­£ç¢ºã«é…ç½®ã™ã‚‹ãŸã‚ã®è¤‡é›‘ãªTransform */
      transform: 
        /* 1. æ–‡å­—ã®ä¸­å¿ƒã‚’ãƒ›ã‚¤ãƒ¼ãƒ«ã®ä¸­å¿ƒã«é…ç½® */
        translate(-50%, -50%)
        /* 2. ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®ä¸­å¿ƒè§’åº¦ã«è¦ç´ ã‚’å›è»¢ (A=0åº¦) */
        rotate(calc(var(--i) * var(--segment-angle) - 90deg)) 
        /* 3. å¤–å´ã¸ç§»å‹• (Yè»¸ã«æ²¿ã£ã¦--text-radiusåˆ†ç§»å‹•) */
        translateY(calc(-1 * var(--text-radius))) 
        /* 4. æ–‡å­—ã®å‘ãã‚’æ‰“ã¡æ¶ˆã™é€†å›è»¢ã‚’é©ç”¨ */
        rotate(calc(var(--i) * var(--segment-angle) * -1 + 90deg));
    }
    
    .center-circle {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: #111827;
      color: #f9fafb;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
      font-size: 14px;
      z-index: 10;
    }

    .pointer {
      position: absolute;
      top: -18px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 16px solid transparent;
      border-right: 16px solid transparent;
      border-bottom: 24px solid #ef4444;
      filter: drop-shadow(0 3px 4px rgba(0, 0, 0, 0.3));
      z-index: 20;
    }

    button {
      padding: 10px 26px;
      border-radius: 999px;
      border: none;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(to right, #6366f1, #ec4899);
      color: #f9fafb;
      box-shadow: 0 8px 16px rgba(79, 70, 229, 0.4);
      transition: transform 0.1s ease, box-shadow 0.1s ease, filter 0.1s ease;
    }

    button:active {
      transform: translateY(1px) scale(0.99);
      box-shadow: 0 4px 8px rgba(79, 70, 229, 0.5);
      filter: brightness(0.96);
    }

    #result {
      font-size: 18px;
      font-weight: 500;
      color: #111827;
    }

    .segments-info {
      font-size: 13px;
      color: #4b5563;
    }
  </style>
</head>
<body>
  <div class="roulette-wrapper">
    <div class="pointer"></div>
    <div class="wheel" id="wheel">
      <div class="segment-text-container">
        <div class="segment-text" style="--i:0;">A</div>
        <div class="segment-text" style="--i:1;">B</div>
        <div class="segment-text" style="--i:2;">C</div>
        <div class="segment-text" style="--i:3;">D</div>
        <div class="segment-text" style="--i:4;">E</div>
        <div class="segment-text" style="--i:5;">F</div>
      </div>
      <div class="center-circle">ROULETTE</div>
    </div>
  </div>

  <button id="spinButton">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
  <div id="result">ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆé–‹å§‹ï¼</div>
  <div class="segments-info">
    ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ: A / B / C / D / E / F
  </div>

  <script>
    const items = ["A", "B", "C", "D", "E", "F"];

    const wheel = document.getElementById("wheel");
    const spinButton = document.getElementById("spinButton");
    const result = document.getElementById("result");

    let isSpinning = false;
    let baseRotation = 0;      
    let spinAnimationId = null; 

    const segmentCount = items.length;
    const segmentAngle = 360 / segmentCount;

    function continuousSpin() {
      baseRotation = (baseRotation + 10) % 360; 
      wheel.style.transform = `rotate(${baseRotation}deg)`;
      spinAnimationId = requestAnimationFrame(continuousSpin);
    }

    function easeOutQuad(t) {
      return t * (2 - t);
    }

    spinButton.addEventListener("click", () => {
      if (!isSpinning) {
        isSpinning = true;
        spinButton.textContent = "ã‚¹ãƒˆãƒƒãƒ—";
        result.textContent = "ãã‚‹ãã‚‹å›è»¢ä¸­â€¦";
        continuousSpin();
      } else {
        isSpinning = false;
        spinButton.textContent = "ã‚‚ã†ä¸€åº¦";
        cancelAnimationFrame(spinAnimationId);

        const randomIndex = Math.floor(Math.random() * segmentCount);

        const extraSpins = 5;
        // ãƒã‚¤ãƒ³ã‚¿ãƒ¼ãŒã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®ä¸­å¿ƒã‚’æŒ‡ã™ã‚ˆã†ã«èª¿æ•´
        const targetAngleFromTop = randomIndex * segmentAngle + segmentAngle / 2;
        
        const targetRotation = extraSpins * 360 + targetAngleFromTop;

        const startRotation = baseRotation;
        const diff = targetRotation - startRotation;
        const duration = 1200;

        const startTime = performance.now();

        function animateToResult(now) {
          const elapsed = now - startTime;
          const t = Math.min(elapsed / duration, 1);
          const eased = easeOutQuad(t);
          const currentAngle = startRotation + diff * eased;

          wheel.style.transform = `rotate(${currentAngle}deg)`;

          if (t < 1) {
            requestAnimationFrame(animateToResult);
          } else {
            baseRotation = currentAngle % 360;

            const normalized = (360 - baseRotation + 360) % 360; 
            const index = Math.floor(normalized / segmentAngle) % segmentCount;

            const hit = items[index];
            result.textContent = `ğŸ‰ çµæœï¼š${hit} ãŒå½“ãŸã‚Šã¾ã—ãŸï¼`;
          }
        }

        requestAnimationFrame(animateToResult);
      }
    });
  </script>
</body>
</html>